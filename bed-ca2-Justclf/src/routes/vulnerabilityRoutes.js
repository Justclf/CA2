const express = require('express');
const router = express.Router();
const controller = require('../controllers/vulnerabilityController');
const jwtMiddleware = require('../middlewares/jwtMiddleware');

// Create a new vulnerability
router.post("/create", jwtMiddleware.verifyToken, controller.createVulnerability);

// Get all vulnerabilities (for report page)
router.get("/all", jwtMiddleware.verifyToken, controller.getAllVulnerabilities);

// Get user's created vulnerabilities
router.get("/user", jwtMiddleware.verifyToken, controller.getUserVulnerabilities);

// Submit a report on a vulnerability
router.post("/", jwtMiddleware.verifyToken, controller.submitReport);

module.exports = router;